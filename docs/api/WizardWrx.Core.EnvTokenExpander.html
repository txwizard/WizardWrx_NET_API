<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class EnvTokenExpander
   </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class EnvTokenExpander
   ">
    <meta name="generator" content="docfx 2.56.6.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="WizardWrx.Core.EnvTokenExpander">
  
  
  <h1 id="WizardWrx_Core_EnvTokenExpander" data-uid="WizardWrx.Core.EnvTokenExpander" class="text-break">Class EnvTokenExpander
  </h1>
  <div class="markdown level0 summary"><p>This class is implemented as a very lean Singleton.</p>
</div>
  <div class="markdown level0 conceptual"></div>
  <div class="inheritance">
    <h5>Inheritance</h5>
    <div class="level0"><span class="xref">System.Object</span></div>
    <div class="level1"><span class="xref">EnvTokenExpander</span></div>
  </div>
  <div class="inheritedMembers">
    <h5>Inherited Members</h5>
    <div>
      <span class="xref">System.Object.ToString()</span>
    </div>
    <div>
      <span class="xref">System.Object.Equals(System.Object)</span>
    </div>
    <div>
      <span class="xref">System.Object.Equals(System.Object, System.Object)</span>
    </div>
    <div>
      <span class="xref">System.Object.ReferenceEquals(System.Object, System.Object)</span>
    </div>
    <div>
      <span class="xref">System.Object.GetHashCode()</span>
    </div>
    <div>
      <span class="xref">System.Object.GetType()</span>
    </div>
    <div>
      <span class="xref">System.Object.MemberwiseClone()</span>
    </div>
  </div>
  <h6><strong>Namespace</strong>: <a class="xref" href="WizardWrx.Core.html">WizardWrx.Core</a></h6>
  <h6><strong>Assembly</strong>: WizardWrx.Core.dll</h6>
  <h5 id="WizardWrx_Core_EnvTokenExpander_syntax">Syntax</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class EnvTokenExpander</code></pre>
  </div>
  <h3 id="fields">Fields
  </h3>
  
  
  <h4 id="WizardWrx_Core_EnvTokenExpander_ENV_STR_DLM" data-uid="WizardWrx.Core.EnvTokenExpander.ENV_STR_DLM">ENV_STR_DLM</h4>
  <div class="markdown level1 summary"><p>For reference, the character that delminits an environment string
token is exposed as a public constant.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public const char ENV_STR_DLM = '%'</code></pre>
  </div>
  <h5 class="fieldValue">Field Value</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Char</span></td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <h3 id="properties">Properties
  </h3>
  
  
  <a id="WizardWrx_Core_EnvTokenExpander_Busy_" data-uid="WizardWrx.Core.EnvTokenExpander.Busy*"></a>
  <h4 id="WizardWrx_Core_EnvTokenExpander_Busy" data-uid="WizardWrx.Core.EnvTokenExpander.Busy">Busy</h4>
  <div class="markdown level1 summary"><p>Returns TRUE if the EnvTokenExpander is Busy, which means that a thread
has acquired it, by calling its Acquire method.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool Busy { get; }</code></pre>
  </div>
  <h5 class="propertyValue">Property Value</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <h5 id="WizardWrx_Core_EnvTokenExpander_Busy_remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>By acquiring the EnvTokenExpander, a thread can shave a tad off the
processing needed to find the first occurrance of a token, in order
to extract it, if it intends to call ContainsEnvToken before calling
ExtractEnvToken.</p>
</div>
  <h3 id="methods">Methods
  </h3>
  
  
  <a id="WizardWrx_Core_EnvTokenExpander_Acquire_" data-uid="WizardWrx.Core.EnvTokenExpander.Acquire*"></a>
  <h4 id="WizardWrx_Core_EnvTokenExpander_Acquire" data-uid="WizardWrx.Core.EnvTokenExpander.Acquire">Acquire()</h4>
  <div class="markdown level1 summary"><p>Rather than have the caller lock the object, I provide this pair of
methods that create a similar effect, by causing a competing caller
of an object in a Frozen state to told to wait its turn.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool Acquire()</code></pre>
  </div>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td><p>TRUE, unless the object is already frozen by another thread.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="WizardWrx_Core_EnvTokenExpander_ContainsEnvToken_" data-uid="WizardWrx.Core.EnvTokenExpander.ContainsEnvToken*"></a>
  <h4 id="WizardWrx_Core_EnvTokenExpander_ContainsEnvToken_System_String_" data-uid="WizardWrx.Core.EnvTokenExpander.ContainsEnvToken(System.String)">ContainsEnvToken(String)</h4>
  <div class="markdown level1 summary"><p>Returns TRUE if the input string contains at least one environment
string token.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool ContainsEnvToken(string pstrIn)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.String</span></td>
        <td><span class="parametername">pstrIn</span></td>
        <td><p>String to evaluate for presence of environment string tokens.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td><p>TRUE if the string contains at least one environment string token.
Otherwise return FALSE.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="WizardWrx_Core_EnvTokenExpander_ContainsEnvToken_System_String__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>An environment string token is defined as a substring delimited
by '%' charagers, which are symbolically represented by
ENV_STR_DLM in this class.</p>
<p>Because this is a public method of a singleton, it cannot be marked
Static. If it were so marked, it would lose access to the private
storage that motivated me to finally sit down and figure out how to
implement the Singleton pattern in C#.</p>
</div>
  
  
  <a id="WizardWrx_Core_EnvTokenExpander_ExpandEnvironmentTokens_" data-uid="WizardWrx.Core.EnvTokenExpander.ExpandEnvironmentTokens*"></a>
  <h4 id="WizardWrx_Core_EnvTokenExpander_ExpandEnvironmentTokens_System_String_System_String_" data-uid="WizardWrx.Core.EnvTokenExpander.ExpandEnvironmentTokens(System.String,System.String)">ExpandEnvironmentTokens(String, String)</h4>
  <div class="markdown level1 summary"><p>Given a string that contains one or more environment string tokens,
expand the tokens, returning the resulting string.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static string ExpandEnvironmentTokens(string pstrIn, string pstrDefault = null)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.String</span></td>
        <td><span class="parametername">pstrIn</span></td>
        <td><p>String to parse and expand environment string tokens.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.String</span></td>
        <td><span class="parametername">pstrDefault</span></td>
        <td><p>Optional string to return as default if an undefined (empty)
environment variable is encountered in input string
<code data-dev-comment-type="paramref" class="paramref">pstrIn</code>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.String</span></td>
        <td><p>The return value is string <code data-dev-comment-type="paramref" class="paramref">pstrIn</code> with its
environment tokens expanded.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="WizardWrx_Core_EnvTokenExpander_ExtractEnvToken_" data-uid="WizardWrx.Core.EnvTokenExpander.ExtractEnvToken*"></a>
  <h4 id="WizardWrx_Core_EnvTokenExpander_ExtractEnvToken_System_String_" data-uid="WizardWrx.Core.EnvTokenExpander.ExtractEnvToken(System.String)">ExtractEnvToken(String)</h4>
  <div class="markdown level1 summary"><p>If the input string contains an enviroment token, extract and return
it.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public string ExtractEnvToken(string pstrIn)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.String</span></td>
        <td><span class="parametername">pstrIn</span></td>
        <td><p>String from which to extract an environment variable token.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.String</span></td>
        <td><p>String containing the token, minus its delimiters.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="WizardWrx_Core_EnvTokenExpander_ExtractEnvToken_System_String__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>An environment string token is defined as a substring delimited
by '%' charagers, which are symbolically represented by
ENV_STR_DLM in this class.</p>
<p>Since this method returns the string without its delimiters, pass it
to static method TokenizeEnvVarName to convert it to a string that
can be passed into a Replace method, to replace the token with its
value, which you got by calling Environment.GetEnvironmentVariable.</p>
<p>Because this is a public method of a singleton, it cannot be marked
Static. If it were so marked, it would lose access to the private
storage that motivated me to finally sit down and figure out how to
implement the Singleton pattern in C#.</p>
</div>
  
  
  <a id="WizardWrx_Core_EnvTokenExpander_Free_" data-uid="WizardWrx.Core.EnvTokenExpander.Free*"></a>
  <h4 id="WizardWrx_Core_EnvTokenExpander_Free" data-uid="WizardWrx.Core.EnvTokenExpander.Free">Free()</h4>
  <div class="markdown level1 summary"><p>Rather than have the caller lock the object, I provide this pair of
methods that create a similar effect, by causing a competing caller
of an object in a Frozen state to be thrown and exception.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool Free()</code></pre>
  </div>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td><p>Always True.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="WizardWrx_Core_EnvTokenExpander_GetTokenExpander_" data-uid="WizardWrx.Core.EnvTokenExpander.GetTokenExpander*"></a>
  <h4 id="WizardWrx_Core_EnvTokenExpander_GetTokenExpander" data-uid="WizardWrx.Core.EnvTokenExpander.GetTokenExpander">GetTokenExpander()</h4>
  <div class="markdown level1 summary"><p>All classes that want to call methods on this object must first call
this method.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static EnvTokenExpander GetTokenExpander()</code></pre>
  </div>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="WizardWrx.Core.EnvTokenExpander.html">EnvTokenExpander</a></td>
        <td><p>A reference to the single instance of this object, which all
consumers share.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="WizardWrx_Core_EnvTokenExpander_GetTokenExpander_remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>This pseudo-constructor must be declared static. Its only real job
is to return a reference to itself, personified as _TheInstance.</p>
</div>
  
  
  <a id="WizardWrx_Core_EnvTokenExpander_TokenizeEnvVarName_" data-uid="WizardWrx.Core.EnvTokenExpander.TokenizeEnvVarName*"></a>
  <h4 id="WizardWrx_Core_EnvTokenExpander_TokenizeEnvVarName_System_String_" data-uid="WizardWrx.Core.EnvTokenExpander.TokenizeEnvVarName(System.String)">TokenizeEnvVarName(String)</h4>
  <div class="markdown level1 summary"><p>Given a string, assumed to be the name of an environment string,
return it with the expected escape (&quot;quote&quot;) characters appended to
both ends.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static string TokenizeEnvVarName(string pstrIn)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.String</span></td>
        <td><span class="parametername">pstrIn</span></td>
        <td><p>String to turn into an environment variable token.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.String</span></td>
        <td><p>String pstrIn, with the escape characters (%) appended to both ends.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="WizardWrx_Core_EnvTokenExpander_TokenizeEnvVarName_System_String__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>Use this method to turn the output of ExtractEnvToken into a string
that can be fed to a Replace method to substitute the value of the
environment variable for its token.</p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
