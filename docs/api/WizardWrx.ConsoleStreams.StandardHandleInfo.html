<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class StandardHandleInfo
   </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class StandardHandleInfo
   ">
    <meta name="generator" content="docfx 2.39.1.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo">
  
  
  <h1 id="WizardWrx_ConsoleStreams_StandardHandleInfo" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo" class="text-break">Class StandardHandleInfo
  </h1>
  <div class="markdown level0 summary"><p>This static class provides type-safe managed methods to determine the
true redirection state of a standard console handle, including, if
applicable, learning the name of the file to which it is redirected.</p>
</div>
  <div class="markdown level0 conceptual"></div>
  <div class="inheritance">
    <h5>Inheritance</h5>
    <div class="level0"><span class="xref">System.Object</span></div>
    <div class="level1"><span class="xref">StandardHandleInfo</span></div>
  </div>
  <div class="inheritedMembers">
    <h5>Inherited Members</h5>
    <div>
      <span class="xref">System.Object.ToString()</span>
    </div>
    <div>
      <span class="xref">System.Object.Equals(System.Object)</span>
    </div>
    <div>
      <span class="xref">System.Object.Equals(System.Object, System.Object)</span>
    </div>
    <div>
      <span class="xref">System.Object.ReferenceEquals(System.Object, System.Object)</span>
    </div>
    <div>
      <span class="xref">System.Object.GetHashCode()</span>
    </div>
    <div>
      <span class="xref">System.Object.GetType()</span>
    </div>
    <div>
      <span class="xref">System.Object.MemberwiseClone()</span>
    </div>
  </div>
  <h6><strong>Namespace</strong>: <a class="xref" href="WizardWrx.ConsoleStreams.html">WizardWrx.ConsoleStreams</a></h6>
  <h6><strong>Assembly</strong>: WizardWrx.ConsoleStreams.dll</h6>
  <h5 id="WizardWrx_ConsoleStreams_StandardHandleInfo_syntax">Syntax</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static class StandardHandleInfo</code></pre>
  </div>
  <h5 id="WizardWrx_ConsoleStreams_StandardHandleInfo_remarks"><strong>Remarks</strong></h5>
  <div class="markdown level0 remarks"><p>The standard properties on the Process (all versions) and Console
(version 4.5 and newer) objects report based solely on redirections
brought about by the Base Class Library. They completely ignore redirection
that happens in the shell, before the process started. Hence, to learn the
true redirection state requires a couple of Platform Invoke calls into the
Windows API, which this class provides through type-safe wrappers.</p>
</div>
  <h3 id="fields">Fields
  </h3>
  
  
  <h4 id="WizardWrx_ConsoleStreams_StandardHandleInfo_INVALID_HANDLE_VALUE" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo.INVALID_HANDLE_VALUE">INVALID_HANDLE_VALUE</h4>
  <div class="markdown level1 summary"><p>When a routine, such as GetStandardHandle cannot return a usable
file handle, this is the return value, cast to IntPtr, as is the
expected file handle.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static readonly IntPtr INVALID_HANDLE_VALUE</code></pre>
  </div>
  <h5 class="fieldValue">Field Value</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.IntPtr</span></td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <h5 id="WizardWrx_ConsoleStreams_StandardHandleInfo_INVALID_HANDLE_VALUE_remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>Were it not that IntPtr is a structure, INVALID_HANDLE_VALUE would
be defined as a public constant.</p>
</div>
  
  
  <h4 id="WizardWrx_ConsoleStreams_StandardHandleInfo_INVALID_MODULE_HANDLE" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo.INVALID_MODULE_HANDLE">INVALID_MODULE_HANDLE</h4>
  <div class="markdown level1 summary"><p>When a routine, such as GetModuleHandle cannot return a usable
module handle, this is the return value, cast to IntPtr, as is the
expected module handle.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static readonly IntPtr INVALID_MODULE_HANDLE</code></pre>
  </div>
  <h5 class="fieldValue">Field Value</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.IntPtr</span></td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <h5 id="WizardWrx_ConsoleStreams_StandardHandleInfo_INVALID_MODULE_HANDLE_remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>Were it not that IntPtr is a structure, INVALID_HANDLE_VALUE would
be defined as a public constant.</p>
</div>
  <h3 id="methods">Methods
  </h3>
  
  
  <a id="WizardWrx_ConsoleStreams_StandardHandleInfo_GetRedirectedFileName_" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo.GetRedirectedFileName*"></a>
  <h4 id="WizardWrx_ConsoleStreams_StandardHandleInfo_GetRedirectedFileName_WizardWrx_ConsoleStreams_StandardHandleInfo_StandardConsoleHandle_" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo.GetRedirectedFileName(WizardWrx.ConsoleStreams.StandardHandleInfo.StandardConsoleHandle)">GetRedirectedFileName(StandardHandleInfo.StandardConsoleHandle)</h4>
  <div class="markdown level1 summary"><p>Get the name of the file to which a specified standard handle is
redirected.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static string GetRedirectedFileName(StandardHandleInfo.StandardConsoleHandle penmStdHandleID)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="WizardWrx.ConsoleStreams.StandardHandleInfo.StandardConsoleHandle.html">StandardHandleInfo.StandardConsoleHandle</a></td>
        <td><span class="parametername">penmStdHandleID</span></td>
        <td><p>Use a member of the StandardConsoleHandle enumeration to designate
the desired standard console stream.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.String</span></td>
        <td><p>If the file is redirected, the returned string contains the fully
qualified name of the file to which it is redirected. If the handle
is attached to its console (that is, not redirected), the return
value is the empty string.</p>
</td>
      </tr>
    </tbody>
  </table>
  
  
  <a id="WizardWrx_ConsoleStreams_StandardHandleInfo_GetStandardHandleState_" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo.GetStandardHandleState*"></a>
  <h4 id="WizardWrx_ConsoleStreams_StandardHandleInfo_GetStandardHandleState_WizardWrx_ConsoleStreams_StandardHandleInfo_StandardConsoleHandle_" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo.GetStandardHandleState(WizardWrx.ConsoleStreams.StandardHandleInfo.StandardConsoleHandle)">GetStandardHandleState(StandardHandleInfo.StandardConsoleHandle)</h4>
  <div class="markdown level1 summary"><p>Get the redirection state of a specified standard console stream.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static StandardHandleInfo.StandardHandleState GetStandardHandleState(StandardHandleInfo.StandardConsoleHandle penmStdHandleID)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="WizardWrx.ConsoleStreams.StandardHandleInfo.StandardConsoleHandle.html">StandardHandleInfo.StandardConsoleHandle</a></td>
        <td><span class="parametername">penmStdHandleID</span></td>
        <td><p>Use a member of the StandardConsoleHandle enumeration to designate
the desired standard console stream.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="WizardWrx.ConsoleStreams.StandardHandleInfo.StandardHandleState.html">StandardHandleInfo.StandardHandleState</a></td>
        <td><p>The return value is one of the following.</p>
<p>StandardHandleState.Attached means that the specified stream is
attached to its console.</p>
<p>StandardHandleState.Redirected means that the specified stream is
redirected.</p>
<p>Call GetRedirectedFileName to get the fully qualified name of the
file to which it is redirected.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="WizardWrx_ConsoleStreams_StandardHandleInfo_GetStandardHandleState_WizardWrx_ConsoleStreams_StandardHandleInfo_StandardConsoleHandle__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>In all versions of the framework, the following properties report
inaccurately on the true state of the console stream.</p>
<ul>
<li>System.Diagnostics.Process.StartInfo.RedirectStandardInput ,</li>
<li>System.Diagnostics.Process.StartInfo.RedirectStandardOutput ,</li>
<li>System.Diagnostics.Process.StartInfo.RedirectStandardError ,</li>
</ul>
<p>The following properties, added in version 4.5, also report incorrectly.</p>
<ul>
<li>Console.IsErrorRedirected</li>
<li>Console.IsInputRedirected</li>
<li>Console.IsOutputRedirected</li>
</ul>
<p>The above properties report inaccurately because their report is
based entirely on changes made by calls to methods on the Console
class. They exhibit no knowledge, whatsoever, of what the underlying
operating system does in response to shell commands to redirect one
or more of the standard console streams.</p>
<p>On the other hand, since StandardHandleState gets its information
from GetConsoleMode, a native Windows API routine, its report takes
into account console stream redirections that are the result of
shell commands.</p>
</div>
  
  
  <a id="WizardWrx_ConsoleStreams_StandardHandleInfo_GetWin32StatusCode_" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo.GetWin32StatusCode*"></a>
  <h4 id="WizardWrx_ConsoleStreams_StandardHandleInfo_GetWin32StatusCode" data-uid="WizardWrx.ConsoleStreams.StandardHandleInfo.GetWin32StatusCode">GetWin32StatusCode()</h4>
  <div class="markdown level1 summary"><p>Get the last Win32 status code logged by Marshal.GetLastWin32Error.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static int GetWin32StatusCode()</code></pre>
  </div>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Int32</span></td>
        <td><p>The return value is the value returned by the last call to
Marshal.GetLastWin32Error.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="WizardWrx_ConsoleStreams_StandardHandleInfo_GetWin32StatusCode_remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>As is true of the other methods defined by this class, this method
is not yet thread-safe.</p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
